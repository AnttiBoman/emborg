emborg without configs:

    -
        args: version
        expected: emborg version: \d+\.\d+\.\d+ \(\d\d\d\d-\d\d-\d\d\) \[Python \d\.\d+\.\d+\]\.
        expected_type: regex

    -
        args: help
        expected:
            > Emborg Backups
            >
            > Backs up the contents of a file hierarchy.  A front end for Borg's
            > encrypted incremental backup utility.
            >
            > Usage:
            >     emborg [options] [<command> [<args>...]]
            >
            > Options:
            >     -c <cfgname>, --config <cfgname>  Specifies the configuration to use.
            >     -d, --dry-run                     Run Borg in dry run mode.
            >     -h, --help                        Output basic usage information.
            >     -m, --mute                        Suppress all output.
            >     -n, --narrate                     Send emborg and Borg narration to stdout.
            >     -q, --quiet                       Suppress optional output.
            >     -r, --relocated                   Acknowledge that repository was relocated.
            >     -v, --verbose                     Make Borg more verbose.
            >     --no-log                          Do not create log file.
            >
            > Available commands:
            >     borg              run a raw borg command.
            >     breaklock, break-lock
            >                       breaks the repository and cache locks.
            >     check             checks the repository and its archives
            >     compare           compare local files or directories to those in an archive
            >     configs           list available backup configurations
            >     create, backup    create an archive of the current files
            >     delete            delete an archive currently contained in the repository
            >     diff              show the differences between two archives
            >     due               days since last backup
            >     extract           recover file or files from archive
            >     help              give information about commands or other topics
            >     info              print information about a backup
            >     init              initialize the repository
            >     list, lr, archives
            >                       list the archives currently contained in the repository
            >     log               print logfile for the last emborg run
            >     manifest, m, la, files, f
            >                       list the files contained in an archive
            >     mount             mount a repository or archive
            >     prune             prune the repository of excess archives
            >     restore           Restore the given files or directories in place
            >     settings, setting
            >                       list settings of chosen configuration
            >     umount, unmount   un-mount a previously mounted repository or archive
            >     version           display emborg version
            >
            > Available topics:
            >     overview          overview of emborg
            >     precautions       what everybody should know before using emborg

    -
        args: settings --available
        expected:
            > Emborg settings:
            >                    archive: template Borg should use when creating archive
            >                             names
            >         avendesora_account: account name that holds passphrase for
            >                             encryption key in Avendesora
            >           avendesora_field: name of field in Avendesora that holds the
            >                             passphrase
            >            borg_executable: path to borg
            >         check_after_create: run check as the last step of an archive
            >                             creation
            >                colorscheme: the color scheme
            >                 config_dir: absolute path to configuration directory
            >                             (read-only)
            >                config_name: name of active configuration (set by program)
            >             configurations: available Emborg configurations
            >                cronhub_url: the cronhub.io URL for back-ups monitor
            >               cronhub_uuid: the cronhub.io UUID for back-ups monitor
            >      default_configuration: default Emborg configuration
            >        default_mount_point: directory to use as mount point if one is not
            >                             specified
            >              do_not_expand: names of settings that must not undergo
            >                             setting evaluation
            >                   encoding: encoding when talking to borg
            >                 encryption: encryption method (see Borg documentation)
            >               exclude_from: file that contains exclude patterns
            >                   excludes: list of glob strings of files or directories
            >                             to skip
            >           healthchecks_url: the healthchecks.io URL for back-ups monitor
            >          healthchecks_uuid: the healthchecks.io UUID for back-ups monitor
            >                   home_dir: users home directory (read only)
            >                    log_dir: emborg log directory (read only)
            >           manage_diffs_cmd: command to use to manage differences in files
            >                             and directories
            >    manifest_default_format: the format that manifest should use if none is
            >                             specified
            >           manifest_formats: format strings used by manifest
            >                 must_exist: if set, each of these files or directories
            >                             must exist or create will quit with an error
            >            needs_ssh_agent: if set, Emborg will complain if ssh_agent is
            >                             not available
            >                   notifier: notification program
            >                     notify: email address to notify when things go wrong
            >                passcommand: command used by Borg to acquire the passphrase
            >                 passphrase: passphrase for encryption key (if specified,
            >                             Avendesora is not used)
            >                   patterns: patterns that indicate whether a path should
            >                             be included or excluded
            >              patterns_from: file that contains patterns
            >         prune_after_create: run prune after creating an archive
            >           report_diffs_cmd: shell command to use to report differences in
            >                             files and directories
            >                 repository: path to remote directory that contains
            >                             repository
            >           run_after_backup: commands to run after archive has been created
            >      run_after_last_backup: commands to run after last archive has been
            >                             created
            >          run_before_backup: commands to run before archive is created
            >    run_before_first_backup: commands to run before first archive is
            >                             created
            >              show_progress: show borg progress when running create command
            >                 show_stats: show borg statistics when running create,
            >                             delete, and prune commands
            >                   src_dirs: the directories to archive
            >                ssh_command: command to use for SSH, can be used to specify
            >                             SSH options
            >                    verbose: make Borg more verbose
            >                working_dir: working directory
            >
            > Borg settings:
            >                append_only: create an append-only mode repository
            >                compression: compression algorithm
            >             exclude_caches: exclude directories that contain a
            >                             CACHEDIR.TAG file
            >         exclude_if_present: exclude directories that are tagged by
            >                             containing a filesystem object with the given
            >                             NAME
            >             exclude_nodump: exclude files flagged NODUMP
            >                 keep_daily: number of daily archives to keep
            >                keep_hourly: number of hourly archives to keep
            >                  keep_last: number of the most recent archives to keep
            >              keep_minutely: number of minutely archives to keep
            >               keep_monthly: number of monthly archives to keep
            >                keep_weekly: number of weekly archives to keep
            >                keep_within: keep all archives within this time interval
            >                keep_yearly: number of yearly archives to keep
            >                  lock_wait: wait at most SECONDS for acquiring a
            >                             repository/cache lock (default: 1)
            >            one_file_system: stay in the same file system and do not store
            >                             mount points of other file systems
            >                     prefix: only consider archive names starting with this
            >                             prefix
            >                remote_path: name of borg executable on remote platform
            >           remote_ratelimit: set remote network upload rate limit in kiB/s
            >                             (default: 0=unlimited)
            >                      umask: set umask to M (local and remote, default:
            >                             0077)

emborg with configs:

    -
        args: version
        expected: emborg version: \d+\.\d+\.\d+ \(\d\d\d\d-\d\d-\d\d\) \[Python \d\.\d+\.\d+\]\.
        expected_type: regex

    -
        args: settings --available
        expected:
            > Emborg settings:
            >                    archive: template Borg should use when creating archive
            >                             names
            >         avendesora_account: account name that holds passphrase for
            >                             encryption key in Avendesora
            >           avendesora_field: name of field in Avendesora that holds the
            >                             passphrase
            >            borg_executable: path to borg
            >         check_after_create: run check as the last step of an archive
            >                             creation
            >                colorscheme: the color scheme
            >                 config_dir: absolute path to configuration directory
            >                             (read-only)
            >                config_name: name of active configuration (set by program)
            >             configurations: available Emborg configurations
            >                cronhub_url: the cronhub.io URL for back-ups monitor
            >               cronhub_uuid: the cronhub.io UUID for back-ups monitor
            >      default_configuration: default Emborg configuration
            >        default_mount_point: directory to use as mount point if one is not
            >                             specified
            >              do_not_expand: names of settings that must not undergo
            >                             setting evaluation
            >                   encoding: encoding when talking to borg
            >                 encryption: encryption method (see Borg documentation)
            >               exclude_from: file that contains exclude patterns
            >                   excludes: list of glob strings of files or directories
            >                             to skip
            >           healthchecks_url: the healthchecks.io URL for back-ups monitor
            >          healthchecks_uuid: the healthchecks.io UUID for back-ups monitor
            >                   home_dir: users home directory (read only)
            >                    log_dir: emborg log directory (read only)
            >           manage_diffs_cmd: command to use to manage differences in files
            >                             and directories
            >    manifest_default_format: the format that manifest should use if none is
            >                             specified
            >           manifest_formats: format strings used by manifest
            >                 must_exist: if set, each of these files or directories
            >                             must exist or create will quit with an error
            >            needs_ssh_agent: if set, Emborg will complain if ssh_agent is
            >                             not available
            >                   notifier: notification program
            >                     notify: email address to notify when things go wrong
            >                passcommand: command used by Borg to acquire the passphrase
            >                 passphrase: passphrase for encryption key (if specified,
            >                             Avendesora is not used)
            >                   patterns: patterns that indicate whether a path should
            >                             be included or excluded
            >              patterns_from: file that contains patterns
            >         prune_after_create: run prune after creating an archive
            >           report_diffs_cmd: shell command to use to report differences in
            >                             files and directories
            >                 repository: path to remote directory that contains
            >                             repository
            >           run_after_backup: commands to run after archive has been created
            >      run_after_last_backup: commands to run after last archive has been
            >                             created
            >          run_before_backup: commands to run before archive is created
            >    run_before_first_backup: commands to run before first archive is
            >                             created
            >              show_progress: show borg progress when running create command
            >                 show_stats: show borg statistics when running create,
            >                             delete, and prune commands
            >                   src_dirs: the directories to archive
            >                ssh_command: command to use for SSH, can be used to specify
            >                             SSH options
            >                    verbose: make Borg more verbose
            >                working_dir: working directory
            >
            > Borg settings:
            >                append_only: create an append-only mode repository
            >                compression: compression algorithm
            >             exclude_caches: exclude directories that contain a
            >                             CACHEDIR.TAG file
            >         exclude_if_present: exclude directories that are tagged by
            >                             containing a filesystem object with the given
            >                             NAME
            >             exclude_nodump: exclude files flagged NODUMP
            >                 keep_daily: number of daily archives to keep
            >                keep_hourly: number of hourly archives to keep
            >                  keep_last: number of the most recent archives to keep
            >              keep_minutely: number of minutely archives to keep
            >               keep_monthly: number of monthly archives to keep
            >                keep_weekly: number of weekly archives to keep
            >                keep_within: keep all archives within this time interval
            >                keep_yearly: number of yearly archives to keep
            >                  lock_wait: wait at most SECONDS for acquiring a
            >                             repository/cache lock (default: 1)
            >            one_file_system: stay in the same file system and do not store
            >                             mount points of other file systems
            >                     prefix: only consider archive names starting with this
            >                             prefix
            >                remote_path: name of borg executable on remote platform
            >           remote_ratelimit: set remote network upload rate limit in kiB/s
            >                             (default: 0=unlimited)
            >                      umask: set umask to M (local and remote, default:
            >                             0077)

    -
        args: version
        expected: emborg version: \d+\.\d+\.\d+ \(\d\d\d\d-\d\d-\d\d\) \[Python \d\.\d+\.\d+\]\.
        expected_type: regex

    -
        args: --quiet configs
        expected:
            > Available Configurations:
            >     test0
            >     test1
            >     test2
            >     test3
            >     test4
            >     test5
            >     test6
            >     test7
            >     test8
            >     tests=test0,test1,test2,test3
            >
            > Default Configuration:
            >     tests

    -
        args: --quiet --config test0 settings
        expected:
            >               archive: '{prefix}{{now}}'
            >                        'test0-{now}'
            >    check_after_create: True
            >            config_dir: '/«TESTS»/.config/emborg'
            >           config_name: 'test0'
            >        configurations: """
            >                            test0 test1 test2 test3 test4 test5 test6 test7 test8
            >                            tests=test0,test1,test2,test3
            >                        """
            > default_configuration: 'tests'
            >            encryption: 'none'
            >        exclude_caches: True
            >    exclude_if_present: '.nobackup'
            >              excludes: [
            >                            'fm:*/.viminfo',
            >                            'sh:**/.*.swp',
            >                            'sh:**/.*.swo',
            >                        ]
            >              home_dir: '/«TESTS»'
            >           keep_within: '1d'
            >               log_dir: '/«TESTS»/.local/share/emborg'
            >                prefix: '{config_name}-'
            >                        'test0-'
            >    prune_after_create: True
            >            repository: '~/repositories'
            >              src_dirs: ['~/configs']

    -
        args: --quiet --config test0 init

    -
        args: --config test0 list

    -
        args: --config test0 files
        expected: bu error: no archives are available.
        expected_type: error

    -
        args: --quiet create

    -
        args: --quiet --config test0 list
        expected: test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test0 list --include-external
        expected:
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test2-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test2 delete

    -
        args: --quiet --config test0 list --include-external
        expected:
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test0 manifest --name --sort-by-name
        expected:
            > Archive: test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > «TESTS»/configs
            > «TESTS»/configs/README
            > «TESTS»/configs/overdue.conf
            > «TESTS»/configs/settings
            > «TESTS»/configs/subdir
            > «TESTS»/configs/subdir/file
            > «TESTS»/configs/test0
            > «TESTS»/configs/test1
            > «TESTS»/configs/test2
            > «TESTS»/configs/test2excludes
            > «TESTS»/configs/test2passphrase
            > «TESTS»/configs/test3
            > «TESTS»/configs/test4
            > «TESTS»/configs/test5
            > «TESTS»/configs/test6
            > «TESTS»/configs/test6patterns
            > «TESTS»/configs/test7
            > «TESTS»/configs/test7patterns
            > «TESTS»/configs/test8
        expected_type: regex

    -
        args: --quiet --config test0 manifest --name --sort-by-name /«TESTS»/configs/test
        expected:
            > Archive: test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > «TESTS»/configs/test0
            > «TESTS»/configs/test1
            > «TESTS»/configs/test2
            > «TESTS»/configs/test2excludes
            > «TESTS»/configs/test2passphrase
            > «TESTS»/configs/test3
            > «TESTS»/configs/test4
            > «TESTS»/configs/test5
            > «TESTS»/configs/test6
            > «TESTS»/configs/test6patterns
            > «TESTS»/configs/test7
            > «TESTS»/configs/test7patterns
            > «TESTS»/configs/test8
        expected_type: regex

    -
        args: --quiet create

    -
        args: --quiet --config test0 list --include-external
        expected:
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test2-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test0 prune

    -
        args: --quiet --config test0 prune --include-external

    -
        args: --quiet --config test0 check

    -
        args: --quiet --config test0 check --all

    -
        args: --quiet --config test0 check --include-external

    -
        args: --quiet --config test0 list --include-external
        expected:
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test0-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test1-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test2-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > test3-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet due
        expected:
            > The latest test0 archive was created (just now|(\d+ )?seconds ago)\.
            > The latest test1 archive was created (just now|(\d+ )?seconds ago)\.
            > The latest test2 archive was created (just now|(\d+ )?seconds ago)\.
            > The latest test3 archive was created (just now|(\d+ )?seconds ago)\.
        expected_type: regex

    -
        args: --quiet --config test0 info
        expected:
            >               config: test0
            >                roots: /«TESTS»/configs
            >          destination: /«TESTS»/repositories
            >   settings directory: /«TESTS»/.config/emborg
            >              logfile: /«TESTS»/.local/share/emborg/test0.log
            >       last backed up: .*
            >
            > Repository ID: \w*
            > Location: /«TESTS»/repositories
            > Encrypted: No
            > Cache: /«TESTS»/.cache/borg/\w+
            > Security dir: /«TESTS»/.config/borg/security/\w+
            > ------------------------------------------------------------------------------
            >                        Original size      Compressed size    Deduplicated size
            > All archives:          .............      ...............    .................
            >
            >                        Unique chunks         Total chunks
            > Chunk index:           .............         ............
        expected_type: regex

    -
        args: --quiet --config test0 extract /«TESTS»/configs
        cmp_dirs: /«TESTS»/CONFIGS configs

    -
        remove: configs
        args: --quiet --config test0 restore configs
        cmp_dirs: CONFIGS configs

    -
        args: --quiet --config test0 mount EMBORG
        cmp_dirs: EMBORG/«TESTS»/configs configs
        # if this test fails with 'EMBORG: Mountpoint must be a writable', it is 
        # because EMBORG is still mounted from a previous run.

    -
        args: --quiet --config test0 create
        expected:
            > bu error: borg create:
            >     Failed to create/acquire the lock [^ ]*/emborg/tests/repositories/lock \(timeout\)\.
            >         Perhaps your still have an archive mounted\?
        expected_type: error regex

    -
        args: --quiet --config test0 umount EMBORG

    -
        args: --quiet --config test4 create

    -
        args: --quiet --config test4 list
        expected: test4-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test4 files -S
        expected:
            > Archive: test4-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            >        0 configs/
            >        0 configs/subdir/
            >        0 configs/subdir/file
            >       13 configs/test2passphrase
            >       52 configs/test6patterns
            >       66 configs/test2excludes
            >       84 configs/test7patterns
            >       87 configs/test7
            >      108 configs/test0
            >      125 configs/test6
            >      141 configs/test2
            >      176 configs/test5
            >      182 configs/test8
            >      195 configs/test1
            >      196 configs/test4
            >      253 configs/test3
            >      556 configs/overdue.conf
            >      594 configs/settings
            >     1620 configs/README
        expected_type: regex

    -
        remove: configs/test4
        args: --quiet --config test4 compare configs
        expected:
            > Only in /home/ken/src/emborg/tests/EMBORG/configs: test4
        expected_type: diff

    -
        remove: configs/subdir/file
        args: --quiet --config test4 compare configs/subdir
        expected:
            > Only in /home/ken/src/emborg/tests/EMBORG/configs/subdir: file
        expected_type: diff

    -
        remove: configs
        args: --quiet --config test4 extract -f configs
        cmp_dirs: CONFIGS configs

    -
        remove: configs
        args: --quiet --config test4 extract -f /«TESTS»/configs
        cmp_dirs: CONFIGS configs

    -
        remove: configs
        args: --quiet --config test4 restore configs
        cmp_dirs: CONFIGS configs

    -
        args: --quiet --config test4 mount
        cmp_dirs: EMBORG/configs configs

    -
        args: --quiet --config test4 umount

    -
        args: --quiet --config test4 borg list --prefix test4- --short @repo
        expected: test4-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test4 compare configs

    -
        args: --quiet --config test4 compare configs/subdir

    -
        args: --quiet --config test4 compare --interactive configs

    -
        args: --quiet --config test5 create

    -
        args: --quiet --config test5 list
        expected: test5-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test5 files -N
        expected:
            > Archive: test5-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > «TESTS»/configs/
            > «TESTS»/configs/README
            > «TESTS»/configs/overdue.conf
            > «TESTS»/configs/settings
            > «TESTS»/configs/subdir/
            > «TESTS»/configs/subdir/file
            > «TESTS»/configs/test0
            > «TESTS»/configs/test1
            > «TESTS»/configs/test2
            > «TESTS»/configs/test2excludes
            > «TESTS»/configs/test2passphrase
            > «TESTS»/configs/test3
            > «TESTS»/configs/test4
            > «TESTS»/configs/test5
            > «TESTS»/configs/test6
            > «TESTS»/configs/test6patterns
            > «TESTS»/configs/test7
            > «TESTS»/configs/test7patterns
            > «TESTS»/configs/test8
        expected_type: regex

    -
        args: --quiet --config test5 extract configs
        expected:
            > bu error: borg extract: Include pattern 'configs' never matched.
        expected_type: error

    -
        args: --quiet --config test5 extract /«TESTS»/configs
        cmp_dirs: «TESTS»/configs configs

    -
        remove: configs
        args: --quiet --config test5 restore configs
        cmp_dirs: CONFIGS configs

    -
        args: --quiet --config test5 mount
        cmp_dirs: EMBORG/«TESTS»/configs CONFIGS

    -
        args: --quiet --config test5 umount

    -
        args: --quiet --config test5 borg list --prefix test5- --short @repo
        expected: test5-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test5 compare configs

    -
        args: --quiet --config test5 compare --interactive configs

    -
        args: --quiet --config test6 create

    -
        args: --quiet --config test6 list
        expected: test6-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test6 files -S
        expected:
            > Archive: test6-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            >        0 configs/
            >        0 configs/subdir/
            >        0 configs/subdir/file
            >       13 configs/test2passphrase
            >       52 configs/test6patterns
            >       66 configs/test2excludes
            >       84 configs/test7patterns
            >       87 configs/test7
            >      108 configs/test0
            >      125 configs/test6
            >      141 configs/test2
            >      176 configs/test5
            >      182 configs/test8
            >      195 configs/test1
            >      196 configs/test4
            >      253 configs/test3
            >      556 configs/overdue.conf
            >      594 configs/settings
            >     1620 configs/README
        expected_type: regex

    -
        remove: configs
        args: --quiet --config test6 extract -f configs
        cmp_dirs: CONFIGS configs

    -
        remove: configs
        args: --quiet --config test6 extract -f /«TESTS»/configs
        cmp_dirs: CONFIGS configs

    -
        remove: configs
        args: --quiet --config test6 restore configs
        cmp_dirs: CONFIGS configs

    -
        args: --quiet --config test6 mount
        cmp_dirs: EMBORG/configs configs

    -
        args: --quiet --config test6 umount

    -
        args: --quiet --config test6 borg list --prefix test6- --short @repo
        expected: test6-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test6 compare
        expected: bu error: no diff command available.
        expected_type: error

    -
        args: --quiet --config test7 create

    -
        args: --quiet --config test7 list
        expected: test7-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test7 files -N configs/subdir
        expected:
            > Archive: test7-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > «TESTS»/configs/subdir/
            > «TESTS»/configs/subdir/file
        expected_type: regex

    -
        args: --quiet --config test7 extract configs
        expected:
            > bu error: borg extract: Include pattern 'configs' never matched.
        expected_type: error

    -
        args: --quiet --config test7 extract /«TESTS»/configs
        cmp_dirs: «TESTS»/configs configs

    -
        remove: configs
        args: --quiet --config test7 restore configs
        cmp_dirs: CONFIGS configs

    -
        args: --quiet --config test7 mount
        cmp_dirs: EMBORG/«TESTS»/configs CONFIGS

    -
        args: --quiet --config test7 umount

    -
        args: --quiet --config test7 borg list --prefix test7- --short @repo
        expected: test7-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --config test7 delete --repo

    -
        args: --config test7 list
        expected:
            > bu error: borg list:
            >     Repository [^ ]*/emborg/tests/repositories does not exist\.
        expected_type: error regex

    -
        args: --quiet --config test8 init

    -
        args: --quiet --config test8 create

    -
        args: --quiet --config test8 list
        expected: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

    -
        args: --quiet --config test8 files -D
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > \d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\d\d\d\d configs.symlink/subdir/file
            > \d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.\d\d\d\d\d\d configs.symlink/subdir/
        expected_type: regex

    -
        args: --quiet --config test8 files --date 1h
        expected: bu error: no archive available is older than 1h (an hour ago).
        expected_type: error

    -
        args: --quiet --config test8 files --date «DATE» --sort-by-name
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files -O
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > \w+\s* configs.symlink/subdir/
            > \w+\s* configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files -G
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > \w+\s* configs.symlink/subdir/
            > \w+\s* configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files -K path
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files --name
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files --short
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files --short
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files does-not-exist
        expected: bu error: not contained in a source directory: does-not-exist
        expected_type: error

    -
        args: --quiet --config test8 files configs.symlink/subdir/file
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files configs.symlink/subdir
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        args: --quiet --config test8 files --recursive configs.symlink/subdir
        expected:
            > Archive: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
            > configs.symlink/subdir/
            > configs.symlink/subdir/file
        expected_type: regex

    -
        remove: configs/subdir/file
        args: --quiet --config test8 extract -f configs.symlink/subdir/file
        cmp_dirs: CONFIGS/subdir ./«TESTS»/configs/subdir

    -
        remove: configs/subdir/file
        args: --quiet --config test8 extract -f /«TESTS»/configs.symlink/subdir/file
        cmp_dirs: CONFIGS/subdir ./«TESTS»/configs/subdir

    -
        remove: configs/subdir
        args: --quiet --config test8 restore configs/subdir
        cmp_dirs: CONFIGS/subdir configs/subdir

    -
        remove: configs/subdir/file
        args: --quiet --config test8 restore configs/subdir/file
        cmp_dirs: CONFIGS/subdir configs/subdir

    -
        args: --quiet --config test8 mount
        cmp_dirs: EMBORG/configs.symlink/subdir configs.symlink/subdir

    -
        args: --quiet --config test8 umount

    -
        args: --quiet --config test8 borg list --prefix test8- --short @repo
        expected: test8-\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d
        expected_type: regex

emborg-overdue:

    -
        expected:
            > test0: 0.[01] hours
            > test1: 0.[01] hours
            > test2: 0.[01] hours
            > test3: 0.[01] hours
            > test4: 0.[01] hours
            > test5: 0.[01] hours
            > test6: 0.[01] hours
            > test7: 0.[01] hours
            >
        expected_type: regex

    -
        args: --no-passes
        expected:

